<!DOCTYPE html>
<html lang="pt-BR" class="antialiased">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#16a34a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>QuantixNutri Ultimate AI - System Core</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="style.css">
    
    <!-- External Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/locale/pt-br.js"></script>
    
    <!-- Tailwind Configuration -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'system-ui', '-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial', 'sans-serif'],
                        mono: ['Fira Code', 'Courier New', 'monospace'],
                    },
                    colors: {
                        brand: {
                            50: '#f0fdf4',
                            100: '#dcfce7',
                            200: '#bbf7d0',
                            300: '#86efac',
                            400: '#4ade80',
                            500: '#22c55e',
                            600: '#16a34a',
                            700: '#15803d',
                            800: '#166534',
                            900: '#14532d',
                            950: '#052e16',
                        },
                        dark: {
                            bg: '#0B0F19',
                            card: '#151B2B',
                            border: '#2A3241',
                            text: '#E2E8F0',
                            muted: '#94A3B8'
                        },
                        water: {
                            light: '#38bdf8',
                            DEFAULT: '#0ea5e9',
                            dark: '#0284c7'
                        }
                    },
                    boxShadow: {
                        'glow-green': '0 0 20px -5px rgba(34, 197, 94, 0.5)',
                        'glow-blue': '0 0 20px -5px rgba(14, 165, 233, 0.5)',
                        'glass': '0 8px 32px 0 rgba(31, 38, 135, 0.07)',
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1)',
                        'slide-up': 'slideUp 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)',
                        'slide-down': 'slideDown 0.3s ease-out',
                        'slide-left': 'slideLeft 0.3s ease-out',
                        'scale-in': 'scaleIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)',
                        'bounce-soft': 'bounceSoft 2s infinite',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'spin-slow': 'spin 3s linear infinite',
                        'shimmer': 'shimmer 2s linear infinite',
                    },
                    keyframes: {
                        fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
                        slideUp: { 
                            '0%': { transform: 'translateY(30px)', opacity: '0' }, 
                            '100%': { transform: 'translateY(0)', opacity: '1' } 
                        },
                        slideDown: { 
                            '0%': { transform: 'translateY(-20px)', opacity: '0' }, 
                            '100%': { transform: 'translateY(0)', opacity: '1' } 
                        },
                        slideLeft: {
                            '0%': { transform: 'translateX(20px)', opacity: '0' },
                            '100%': { transform: 'translateX(0)', opacity: '1' }
                        },
                        scaleIn: {
                            '0%': { transform: 'scale(0.9)', opacity: '0' },
                            '100%': { transform: 'scale(1)', opacity: '1' }
                        },
                        bounceSoft: {
                            '0%, 100%': { transform: 'translateY(-3%)' },
                            '50%': { transform: 'translateY(0)' }
                        },
                        shimmer: {
                            '0%': { backgroundPosition: '-1000px 0' },
                            '100%': { backgroundPosition: '1000px 0' }
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="flex justify-center items-center">

    <!-- ONBOARDING OVERLAY (Fullscreen) -->
    <div id="onboarding-overlay" class="fixed inset-0 bg-white dark:bg-dark-bg z-[60] hidden flex-col items-center justify-center p-6 text-center animate-fade-in">
        <div class="w-full max-w-sm">
            <div class="w-20 h-20 mx-auto bg-gradient-to-br from-brand-400 to-brand-600 rounded-3xl flex items-center justify-center text-white shadow-glow-green mb-6">
                <i class="fas fa-leaf text-4xl"></i>
            </div>
            <h1 class="text-2xl font-black text-gray-800 dark:text-white mb-2">Quantix<span class="text-brand-500">AI</span></h1>
            <p class="text-gray-400 text-sm mb-8">Antes de come√ßar, precisamos configurar seu perfil para a IA funcionar corretamente.</p>

            <div class="space-y-4 text-left">
                 <div class="bg-gray-50 dark:bg-dark-card p-4 rounded-2xl border border-gray-100 dark:border-dark-border">
                    <label class="text-xs font-bold text-gray-400 uppercase">Seu Nome</label>
                    <input type="text" id="onb-name" class="w-full bg-transparent text-lg font-bold text-gray-800 dark:text-white mt-1 outline-none" placeholder="Digite seu nome">
                </div>

                <div class="grid grid-cols-2 gap-3">
                    <div class="bg-gray-50 dark:bg-dark-card p-3 rounded-2xl border border-gray-100 dark:border-dark-border">
                        <label class="text-[10px] font-bold text-gray-400 uppercase">Peso (kg)</label>
                        <input type="number" id="onb-weight" class="w-full bg-transparent text-lg font-bold outline-none" placeholder="00.0">
                    </div>
                    <div class="bg-gray-50 dark:bg-dark-card p-3 rounded-2xl border border-gray-100 dark:border-dark-border">
                        <label class="text-[10px] font-bold text-gray-400 uppercase">Altura (cm)</label>
                        <input type="number" id="onb-height" class="w-full bg-transparent text-lg font-bold outline-none" placeholder="170">
                    </div>
                    <div class="bg-gray-50 dark:bg-dark-card p-3 rounded-2xl border border-gray-100 dark:border-dark-border">
                        <label class="text-[10px] font-bold text-gray-400 uppercase">Idade</label>
                        <input type="number" id="onb-age" class="w-full bg-transparent text-lg font-bold outline-none" placeholder="25">
                    </div>
                     <div class="bg-gray-50 dark:bg-dark-card p-3 rounded-2xl border border-gray-100 dark:border-dark-border">
                        <label class="text-[10px] font-bold text-gray-400 uppercase">Meta (Kcal)</label>
                        <input type="number" id="onb-target" class="w-full bg-transparent text-lg font-bold outline-none" placeholder="2000" value="2000">
                    </div>
                </div>
            </div>

            <button onclick="App.finishOnboarding()" class="w-full mt-8 py-4 bg-gray-900 dark:bg-white dark:text-black text-white rounded-xl font-bold text-lg shadow-lg hover:scale-[1.02] transition-transform">
                Come√ßar Jornada
            </button>
        </div>
    </div>

    <!-- CAMERA OVERLAY (Simula Interface Nativa) -->
    <div id="camera-overlay">
        <div class="absolute top-4 left-4 z-50">
            <button onclick="App.closeCamera()" class="w-10 h-10 rounded-full bg-black/50 text-white flex items-center justify-center backdrop-blur">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="viewfinder relative">
            <video id="camera-feed" autoplay playsinline class="w-full h-full object-cover"></video>
            <!-- Focus Frame Animation -->
            <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
                <div class="w-64 h-64 border border-white/30 rounded-lg relative">
                    <div class="absolute top-0 left-0 w-4 h-4 border-t-2 border-l-2 border-green-500"></div>
                    <div class="absolute top-0 right-0 w-4 h-4 border-t-2 border-r-2 border-green-500"></div>
                    <div class="absolute bottom-0 left-0 w-4 h-4 border-b-2 border-l-2 border-green-500"></div>
                    <div class="absolute bottom-0 right-0 w-4 h-4 border-b-2 border-r-2 border-green-500"></div>
                </div>
            </div>
            <div class="absolute bottom-4 left-0 w-full text-center">
                <span class="bg-black/50 text-white text-xs px-2 py-1 rounded backdrop-blur">IA Detectando...</span>
            </div>
        </div>

        <div class="camera-controls">
            <button class="w-10 h-10 rounded-full bg-gray-800 text-white flex items-center justify-center">
                <i class="fas fa-bolt"></i>
            </button>
            <button onclick="App.capturePhoto()" class="shutter-btn"></button>
            <button onclick="App.toggleCameraFacing()" class="w-10 h-10 rounded-full bg-gray-800 text-white flex items-center justify-center">
                <i class="fas fa-sync"></i>
            </button>
        </div>
    </div>

    <!-- MAIN APP CONTAINER -->
    <div id="app-container" class="w-full max-w-md h-full bg-gray-50 dark:bg-dark-bg shadow-2xl relative flex flex-col sm:rounded-[30px] sm:h-[95vh] sm:border border-gray-200 dark:border-dark-border overflow-hidden">
        
        <!-- TOP HEADER -->
        <header class="glass-header h-16 px-4 flex justify-between items-center z-30 absolute top-0 w-full">
            <div class="flex items-center gap-3">
                <div class="relative">
                    <div class="w-9 h-9 rounded-full bg-gradient-to-br from-brand-400 to-brand-600 flex items-center justify-center text-white shadow-lg shadow-brand-500/30">
                        <i class="fas fa-leaf text-sm"></i>
                    </div>
                    <div class="absolute -bottom-1 -right-1 bg-yellow-400 text-[8px] font-bold px-1 rounded-full border border-white text-yellow-900" id="user-level-badge">LVL 1</div>
                </div>
                <div>
                    <h1 class="font-bold text-sm text-gray-800 dark:text-white leading-tight" id="header-username">Quantix<span class="text-brand-500">AI</span></h1>
                    <!-- XP Bar -->
                    <div class="w-20 h-1.5 bg-gray-200 dark:bg-gray-700 rounded-full mt-0.5 overflow-hidden">
                        <div id="xp-bar" class="h-full bg-yellow-400 rounded-full w-0 transition-all duration-500"></div>
                    </div>
                </div>
            </div>

            <div class="flex gap-2">
                <div class="flex items-center gap-1 bg-orange-50 dark:bg-orange-900/20 px-2 py-1 rounded-lg border border-orange-100 dark:border-orange-800/30">
                    <i class="fas fa-fire text-orange-500 text-xs animate-pulse-slow"></i>
                    <span id="streak-display" class="text-xs font-bold text-orange-600 dark:text-orange-400">0</span>
                </div>
                <div class="flex items-center gap-1 bg-brand-50 dark:bg-brand-900/20 px-2 py-1 rounded-lg border border-brand-100 dark:border-brand-800/30 cursor-pointer hover:bg-brand-100 transition" onclick="Modal.open('credits')">
                    <i class="fas fa-bolt text-yellow-500 text-xs"></i>
                    <span id="credits-display" class="text-xs font-bold text-brand-700 dark:text-brand-400">0</span>
                </div>
                <button onclick="App.toggleTheme()" class="w-8 h-8 rounded-full flex items-center justify-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition">
                    <i class="fas fa-moon dark:hidden"></i>
                    <i class="fas fa-sun hidden dark:block"></i>
                </button>
            </div>
        </header>

        <!-- SCROLLABLE CONTENT AREA -->
        <main class="flex-grow overflow-y-auto custom-scrollbar pt-20 pb-32 px-4 scroll-smooth" id="main-scroll">
            
            <!-- === TAB 1: TRACKER === -->
            <div id="tab-tracker" class="tab-content active space-y-6">
                
                <!-- Hero Dashboard -->
                <div class="glass-panel p-5 rounded-3xl relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-32 h-32 bg-brand-500/10 rounded-bl-full -mr-8 -mt-8 pointer-events-none"></div>
                    
                    <div class="flex items-center gap-4 mb-6">
                        <div class="w-24 h-24 relative">
                            <canvas id="chart-macros-today"></canvas>
                        </div>
                        <div class="flex-1">
                            <span class="text-[10px] font-bold text-gray-400 uppercase tracking-widest">Saldo Dispon√≠vel</span>
                            <div class="flex items-center gap-1">
                                <span id="hero-cals-left" class="text-3xl font-black text-gray-800 dark:text-white tracking-tighter">0</span>
                                <span class="text-xs font-medium text-gray-400">kcal</span>
                            </div>
                            <p class="text-[9px] text-gray-400 mt-1">Meta: <span id="hero-target">2000</span></p>
                            <button onclick="App.suggestMeal()" class="mt-2 text-[9px] font-bold bg-brand-100 text-brand-700 px-2 py-1 rounded-lg border border-brand-200 hover:bg-brand-200 transition flex items-center gap-1">
                                <i class="fas fa-lightbulb"></i> O que comer agora?
                            </button>
                            <button onclick="Modal.open('fridge')" class="mt-1 text-[9px] font-bold bg-blue-100 text-blue-700 px-2 py-1 rounded-lg border border-blue-200 hover:bg-blue-200 transition flex items-center gap-1">
                                <i class="fas fa-refrigerator"></i> Limpa Geladeira
                            </button>
                        </div>
                    </div>

                    <!-- Macro Bars -->
                    <div class="space-y-3">
                        <div>
                            <div class="flex justify-between text-[10px] font-bold mb-1">
                                <span class="text-blue-500">Prote√≠na</span>
                                <span id="lbl-macro-p" class="text-gray-500 dark:text-gray-400">0 / 0g</span>
                            </div>
                            <div class="h-2 w-full bg-gray-100 dark:bg-gray-700 rounded-full overflow-hidden">
                                <div id="bar-macro-p" class="h-full bg-blue-500 rounded-full transition-all duration-1000 w-0"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between text-[10px] font-bold mb-1">
                                <span class="text-green-500">Carboidrato</span>
                                <span id="lbl-macro-c" class="text-gray-500 dark:text-gray-400">0 / 0g</span>
                            </div>
                            <div class="h-2 w-full bg-gray-100 dark:bg-gray-700 rounded-full overflow-hidden">
                                <div id="bar-macro-c" class="h-full bg-green-500 rounded-full transition-all duration-1000 w-0"></div>
                            </div>
                        </div>
                        <div>
                            <div class="flex justify-between text-[10px] font-bold mb-1">
                                <span class="text-yellow-500">Gordura</span>
                                <span id="lbl-macro-f" class="text-gray-500 dark:text-gray-400">0 / 0g</span>
                            </div>
                            <div class="h-2 w-full bg-gray-100 dark:bg-gray-700 rounded-full overflow-hidden">
                                <div id="bar-macro-f" class="h-full bg-yellow-500 rounded-full transition-all duration-1000 w-0"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Action Grid -->
                <div class="grid grid-cols-2 gap-4">
                    <!-- Water Card -->
                    <div class="glass-panel p-4 rounded-3xl relative overflow-hidden group active:scale-95 transition-transform duration-200 cursor-pointer" onclick="App.addWater(250)">
                        <div class="absolute inset-0 bg-blue-500/5 group-hover:bg-blue-500/10 transition"></div>
                        <div class="absolute bottom-0 right-0 w-16 h-16 bg-blue-400/20 rounded-tl-3xl -mr-4 -mb-4"></div>
                        
                        <div class="relative z-10">
                            <div class="flex justify-between items-start">
                                <div class="w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-blue-500">
                                    <i class="fas fa-tint text-xs"></i>
                                </div>
                                <span id="water-val" class="text-lg font-bold text-gray-800 dark:text-white">0ml</span>
                            </div>
                            <p class="text-[10px] text-gray-400 font-bold uppercase mt-2">Hidrata√ß√£o</p>
                            <div class="w-full h-1 bg-gray-200 dark:bg-gray-700 rounded-full mt-2 overflow-hidden">
                                <div id="water-bar-mini" class="h-full bg-blue-500 w-0"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Fasting Card -->
                    <div class="glass-panel p-4 rounded-3xl relative overflow-hidden active:scale-95 transition-transform duration-200 cursor-pointer" onclick="App.toggleFasting()">
                        <div class="absolute inset-0 bg-orange-500/5 hover:bg-orange-500/10 transition"></div>
                        
                        <div class="relative z-10">
                            <div class="flex justify-between items-start">
                                <div class="w-8 h-8 rounded-full bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center text-orange-500">
                                    <i class="fas fa-stopwatch text-xs"></i>
                                </div>
                                <span id="fasting-state-text" class="text-[10px] font-bold bg-gray-200 dark:bg-gray-700 px-2 py-0.5 rounded text-gray-500">OFF</span>
                            </div>
                            <div class="mt-1">
                                <span id="fasting-timer" class="text-lg font-mono font-bold text-gray-800 dark:text-white tracking-tight">--:--</span>
                            </div>
                            <p class="text-[10px] text-gray-400 font-bold uppercase mt-1">Jejum Intermitente</p>
                        </div>
                    </div>
                </div>

                <!-- Feed Section -->
                <div>
                    <div class="flex justify-between items-end mb-4 px-1">
                        <h3 class="font-bold text-gray-800 dark:text-gray-100">Linha do Tempo</h3>
                        <button onclick="Modal.open('add-food')" class="text-xs font-bold text-brand-600 bg-brand-50 dark:bg-brand-900/20 px-3 py-1.5 rounded-lg border border-brand-100 dark:border-brand-800/30 hover:bg-brand-100 transition shadow-sm">
                            <i class="fas fa-plus mr-1"></i> Registrar
                        </button>
                    </div>

                    <div id="feed-container" class="space-y-3 pb-20">
                        <!-- Empty State (Injetado via JS se vazio) -->
                        <div class="text-center py-10 opacity-50">
                            <i class="fas fa-utensils text-4xl text-gray-300 mb-2"></i>
                            <p class="text-xs text-gray-400">Seu di√°rio est√° vazio hoje.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- === TAB 2: ANALYTICS === -->
            <div id="tab-analytics" class="tab-content hidden space-y-6">
                <!-- Range Selector -->
                <div class="flex bg-white dark:bg-dark-card p-1 rounded-xl shadow-sm border border-gray-100 dark:border-dark-border">
                    <button onclick="Analytics.setRange(1)" id="btn-range-1" class="flex-1 py-1.5 rounded-lg text-[10px] font-bold transition text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800">Hoje</button>
                    <button onclick="Analytics.setRange(7)" id="btn-range-7" class="flex-1 py-1.5 rounded-lg text-[10px] font-bold transition bg-brand-100 text-brand-700">7 Dias</button>
                    <button onclick="Analytics.setRange(15)" id="btn-range-15" class="flex-1 py-1.5 rounded-lg text-[10px] font-bold text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800">15 Dias</button>
                    <button onclick="Analytics.setRange(30)" id="btn-range-30" class="flex-1 py-1.5 rounded-lg text-[10px] font-bold text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800">30 Dias</button>
                </div>

                <!-- Heatmap Section -->
                <div class="glass-panel p-4 rounded-3xl">
                    <div class="flex justify-between items-center mb-2">
                        <h3 class="text-xs font-bold text-gray-500 uppercase">Consist√™ncia</h3>
                        <div id="heatmap-month" class="text-[10px] font-bold text-brand-600 dark:text-brand-400">--</div>
                    </div>
                    
                    <!-- Weekday Headers -->
                    <div id="heatmap-weekdays" class="grid grid-cols-7 gap-1 mb-1 text-center">
                        <!-- Injected via JS -->
                    </div>

                    <div id="heatmap-grid" class="grid grid-cols-7 gap-1"></div>
                </div>

                <!-- Weight Projection -->
                <div class="bg-gradient-to-br from-indigo-600 to-purple-700 rounded-3xl p-5 text-white shadow-lg relative overflow-hidden">
                    <i class="fas fa-chart-line absolute -bottom-4 -right-4 text-[100px] opacity-10"></i>
                    <h3 class="text-[10px] font-bold opacity-70 uppercase tracking-widest mb-1">Previs√£o IA (30 Dias)</h3>
                    <div class="flex items-end gap-3">
                        <span id="proj-weight" class="text-4xl font-black tracking-tight">--</span>
                        <div class="mb-1.5">
                            <span class="text-sm opacity-80">kg</span>
                            <span id="proj-diff" class="text-xs font-bold bg-white/20 px-1.5 py-0.5 rounded ml-1">--</span>
                        </div>
                    </div>
                    <p class="text-[9px] opacity-60 mt-3 max-w-[80%]">Baseado no seu d√©ficit cal√≥rico m√©dio e TMB atual.</p>
                </div>

                <!-- Exercise Evolution Chart -->
                <div class="glass-panel p-4 rounded-3xl">
                    <h3 class="text-xs font-bold text-gray-500 uppercase mb-4">Queima de Calorias (Exerc√≠cios)</h3>
                    <div class="h-40 w-full">
                        <canvas id="chart-exercise"></canvas>
                    </div>
                </div>

                <!-- Quality Score Chart -->
                <div class="glass-panel p-4 rounded-3xl">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xs font-bold text-gray-500 uppercase">Qualidade Alimentar (Score IA)</h3>
                        <span id="avg-quality-label" class="text-[10px] font-bold px-2 py-0.5 rounded bg-brand-100 text-brand-700">M√©dia: --</span>
                    </div>
                    <div class="h-40 w-full">
                        <canvas id="chart-quality"></canvas>
                    </div>
                </div>

                <!-- Hydration Chart -->
                <div class="glass-panel p-4 rounded-3xl">
                    <h3 class="text-xs font-bold text-gray-500 uppercase mb-4">Hidrata√ß√£o Semanal</h3>
                    <div class="h-40 w-full">
                        <canvas id="chart-hydration"></canvas>
                    </div>
                </div>

                <!-- Charts Area -->
                <div class="glass-panel p-4 rounded-3xl">
                    <h3 class="text-xs font-bold text-gray-500 uppercase mb-4">Evolu√ß√£o de Peso</h3>
                    <div class="h-48 w-full">
                        <canvas id="chart-weight"></canvas>
                    </div>
                </div>

                <div class="glass-panel p-4 rounded-3xl">
                    <h3 class="text-xs font-bold text-gray-500 uppercase mb-4">Medidas Corporais</h3>
                    <div class="h-48 w-full">
                        <canvas id="chart-measurements"></canvas>
                    </div>
                </div>

                <div class="glass-panel p-4 rounded-3xl">
                    <h3 class="text-xs font-bold text-gray-500 uppercase mb-4">M√©dia Hor√°ria de Fome</h3>
                    <div class="h-40 w-full">
                        <canvas id="chart-hourly"></canvas>
                    </div>
                </div>
            </div>

            <!-- === TAB 3: PROFILE === -->
            <div id="tab-profile" class="tab-content hidden space-y-6">
                <!-- Profile Header -->
                <div class="text-center pt-2">
                    <div class="w-24 h-24 mx-auto rounded-full bg-gradient-to-tr from-brand-300 to-brand-600 p-1 shadow-glow-green">
                        <div class="w-full h-full rounded-full bg-white dark:bg-dark-card flex items-center justify-center">
                            <i class="fas fa-user text-4xl text-gray-300"></i>
                        </div>
                    </div>
                    <h2 class="text-xl font-bold mt-3 text-gray-800 dark:text-white">Meu Perfil</h2>
                    <p class="text-xs text-gray-400" id="profile-subtitle">Iniciante ‚Ä¢ N√≠vel 1</p>
                </div>

                <!-- API USAGE MONITOR (Test Phase) -->
                <div class="glass-panel p-4 rounded-3xl border-l-4 border-l-blue-500 shadow-sm">
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="text-[10px] font-bold text-blue-600 uppercase flex items-center gap-2">
                            <i class="fas fa-microchip"></i> Monitor de API (Fase de Testes)
                        </h3>
                        <button onclick="App.resetApiUsage()" class="text-[9px] text-gray-400 hover:text-red-500 transition font-bold uppercase">Zerar</button>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="text-center border-r border-gray-100 dark:border-gray-800">
                            <p class="text-[9px] text-gray-400 uppercase font-bold">Requisi√ß√µes</p>
                            <p id="api-requests" class="text-xl font-black text-blue-600">0</p>
                        </div>
                        <div class="text-center">
                            <p class="text-[9px] text-gray-400 uppercase font-bold">Tokens Totais</p>
                            <p id="api-tokens" class="text-xl font-black text-blue-600">0</p>
                        </div>
                    </div>
                    <p class="text-[8px] text-gray-400 mt-2 italic text-center">* Limite Free Tier: 15 req/min e 1M tokens/min.</p>
                </div>

                <!-- Badges Showcase -->
                <div class="glass-panel p-4 rounded-3xl">
                    <h3 class="text-xs font-bold text-gray-500 uppercase mb-3">Conquistas (Badges)</h3>
                    <div id="badges-grid" class="flex gap-3 overflow-x-auto pb-2 scrollbar-hide">
                        <!-- JS Injected -->
                    </div>
                </div>

                <!-- Settings Form -->
                <div class="bg-white dark:bg-dark-card rounded-3xl p-5 shadow-sm border border-gray-100 dark:border-dark-border">
                    <h3 class="text-xs font-bold text-gray-400 uppercase mb-4 border-b border-gray-100 pb-2">Biometria & Metas</h3>
                    
                    <div class="mb-4">
                        <label class="text-[10px] text-gray-400 font-bold uppercase">Seu Nome</label>
                        <input type="text" id="prof-name" class="input-field w-full rounded-xl p-2.5 text-sm font-bold mt-1 outline-none" placeholder="Como quer ser chamado?">
                    </div>

                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div>
                            <label class="text-[10px] text-gray-400 font-bold uppercase">Peso (kg)</label>
                            <input type="number" id="prof-weight" oninput="Profile.updateBMI()" class="input-field w-full rounded-xl p-2.5 text-sm font-bold mt-1 outline-none">
                        </div>
                        <div>
                            <label class="text-[10px] text-gray-400 font-bold uppercase">Altura (cm)</label>
                            <input type="number" id="prof-height" oninput="Profile.updateBMI()" class="input-field w-full rounded-xl p-2.5 text-sm font-bold mt-1 outline-none">
                        </div>
                        <div>
                            <label class="text-[10px] text-gray-400 font-bold uppercase">Idade</label>
                            <input type="number" id="prof-age" class="input-field w-full rounded-xl p-2.5 text-sm font-bold mt-1 outline-none">
                        </div>
                        <div>
                            <label class="text-[10px] text-gray-400 font-bold uppercase">G√™nero</label>
                            <select id="prof-gender" class="input-field w-full rounded-xl p-2.5 text-xs font-bold mt-1 outline-none">
                                <option value="male">Masculino</option>
                                <option value="female">Feminino</option>
                            </select>
                        </div>
                    </div>

                    <h3 class="text-xs font-bold text-gray-400 uppercase mb-4 mt-6 border-b border-gray-100 pb-2">Medidas Corporais</h3>
                    
                    <!-- Visual Mannequin for Measurements -->
                    <div class="flex justify-center mb-6 bg-gray-50 dark:bg-gray-900/50 py-4 rounded-2xl border border-gray-100 dark:border-gray-800">
                        <div class="relative">
                            <svg width="100" height="160" viewBox="0 0 100 200" class="opacity-80">
                                <path d="M50,10 A15,15 0 1,1 49.9,10 Z" fill="#cbd5e1" /> <!-- Head -->
                                <path d="M30,45 L70,45 L75,100 L25,100 Z" fill="#94a3b8" /> <!-- Torso -->
                                <path d="M25,100 L75,100 L85,140 L15,140 Z" fill="#64748b" /> <!-- Hips -->
                                <rect x="32" y="140" width="15" height="55" rx="5" fill="#475569" /> <!-- Leg L -->
                                <rect x="53" y="140" width="15" height="55" rx="5" fill="#475569" /> <!-- Leg R -->
                                <line x1="20" x2="80" y1="85" y2="85" stroke="#f43f5e" stroke-width="3" stroke-dasharray="4 2" />
                                <circle cx="50" cy="85" r="4" fill="#f43f5e" />
                                <line x1="15" x2="85" y1="120" y2="120" stroke="#ec4899" stroke-width="3" stroke-dasharray="4 2" />
                                <circle cx="50" cy="120" r="4" fill="#ec4899" />
                            </svg>
                            <div class="absolute top-[65px] -right-16 text-[9px] font-bold text-red-500 bg-white dark:bg-gray-800 px-2 py-1 rounded shadow-sm border border-red-100">Cintura</div>
                            <div class="absolute top-[100px] -left-16 text-[9px] font-bold text-pink-500 bg-white dark:bg-gray-800 px-2 py-1 rounded shadow-sm border border-pink-100">Quadril</div>
                        </div>
                    </div>

                    <div class="grid grid-cols-3 gap-3 mb-4">
                        <div>
                            <label class="text-[10px] text-gray-400 font-bold uppercase">Cintura (cm)</label>
                            <input type="number" id="prof-waist" class="input-field w-full rounded-xl p-2 text-xs font-bold mt-1 outline-none">
                        </div>
                        <div>
                            <label class="text-[10px] text-gray-400 font-bold uppercase">Quadril (cm)</label>
                            <input type="number" id="prof-hip" class="input-field w-full rounded-xl p-2 text-xs font-bold mt-1 outline-none">
                        </div>
                        <div>
                            <label class="text-[10px] text-gray-400 font-bold uppercase">% Gordura</label>
                            <input type="number" id="prof-fat" class="input-field w-full rounded-xl p-2 text-xs font-bold mt-1 outline-none">
                        </div>
                    </div>

                    <h3 class="text-xs font-bold text-gray-400 uppercase mb-4 mt-6 border-b border-gray-100 pb-2">Notifica√ß√µes</h3>
                    <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-900 rounded-xl mb-4">
                        <span class="text-xs font-bold text-gray-600 dark:text-gray-300">Lembretes Ativos</span>
                        <button onclick="App.toggleNotifications()" id="btn-notif-toggle" class="w-10 h-6 bg-gray-300 rounded-full relative transition-colors">
                            <div class="absolute left-1 top-1 w-4 h-4 bg-white rounded-full transition-transform" id="notif-toggle-dot"></div>
                        </button>
                    </div>

                    <!-- BMI Display Component -->
                    <div id="bmi-display-area" class="mb-4 bg-gray-50 dark:bg-gray-900 p-3 rounded-xl border border-gray-100 dark:border-gray-800 transition-all">
                        <div class="flex justify-between items-center">
                            <span class="text-[10px] font-bold uppercase text-gray-500">Seu IMC</span>
                            <span id="bmi-value-text" class="text-xs font-black">--</span>
                        </div>
                        <div class="w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full mt-2 overflow-hidden flex">
                            <div class="h-full bg-blue-400 w-[18.5%]"></div>
                            <div class="h-full bg-green-500 w-[25%]"></div>
                            <div class="h-full bg-yellow-400 w-[15%]"></div>
                            <div class="h-full bg-red-500 flex-grow"></div>
                        </div>
                        <div class="flex justify-between mt-1 text-[8px] text-gray-400 font-bold">
                            <span class="text-blue-400">Magreza</span>
                            <span class="text-green-500">Normal</span>
                            <span class="text-yellow-500">Sobrepeso</span>
                            <span class="text-red-500">Obesidade</span>
                        </div>
                        <p id="bmi-classification" class="text-center text-xs font-bold mt-2 text-gray-600 dark:text-gray-300">Calcule seu IMC</p>
                    </div>

                    <div class="mb-4">
                        <label class="text-[10px] text-gray-400 font-bold uppercase">Estrat√©gia Nutricional</label>
                        <select id="prof-strategy" onchange="Profile.toggleCustomMacros()" class="input-field w-full rounded-xl p-3 text-xs font-bold mt-1 outline-none">
                            <option value="balanced">‚öñÔ∏è Equilibrada (30P / 40C / 30G)</option>
                            <option value="lowcarb">ü•© Low Carb (45P / 15C / 40G)</option>
                            <option value="ketogenic">ü•ë Cetog√™nica (25P / 5C / 70G)</option>
                            <option value="custom">üõ†Ô∏è Personalizada</option>
                        </select>
                        
                        <!-- Custom Macros Fields -->
                        <div id="custom-macros-area" class="hidden grid grid-cols-3 gap-2 mt-3 p-3 bg-gray-50 dark:bg-gray-900 rounded-xl">
                            <input type="number" id="cus-p" placeholder="% P" class="text-center text-xs p-2 rounded border border-blue-200">
                            <input type="number" id="cus-c" placeholder="% C" class="text-center text-xs p-2 rounded border border-green-200">
                            <input type="number" id="cus-f" placeholder="% G" class="text-center text-xs p-2 rounded border border-yellow-200">
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-3 mt-4">
                        <div>
                            <label class="text-[10px] text-gray-400 font-bold uppercase">Meta Kcal</label>
                            <input type="number" id="prof-target" class="input-field w-full rounded-xl p-3 text-green-600 font-bold text-center text-lg mt-1 outline-none">
                        </div>
                        <div>
                            <label class="text-[10px] text-gray-400 font-bold uppercase">Meta Fibras</label>
                            <input type="number" id="prof-fiber" class="input-field w-full rounded-xl p-3 text-emerald-600 font-bold text-center text-lg mt-1 outline-none">
                        </div>
                    </div>

                    <button onclick="Profile.save(true)" class="w-full mt-6 bg-gray-900 dark:bg-white dark:text-black text-white py-3.5 rounded-xl font-bold hover:scale-[1.01] transition shadow-lg btn-press">
                        Salvar Altera√ß√µes
                    </button>
                </div>

                <!-- Data Management -->
                <div class="p-2 space-y-2">
                    <button onclick="App.exportData()" class="w-full bg-white dark:bg-dark-card p-3 rounded-xl text-left text-xs font-bold text-blue-500 flex items-center gap-3 shadow-sm">
                        <i class="fas fa-file-export text-lg"></i> Backup de Dados (JSON)
                    </button>
                    <label class="w-full bg-white dark:bg-dark-card p-3 rounded-xl text-left text-xs font-bold text-purple-500 flex items-center gap-3 shadow-sm cursor-pointer">
                        <i class="fas fa-file-import text-lg"></i> Restaurar Backup
                        <input type="file" class="hidden" accept=".json" onchange="App.importData(this)">
                    </label>
                    <button onclick="App.resetAll()" class="w-full bg-red-50 dark:bg-red-900/10 p-3 rounded-xl text-left text-xs font-bold text-red-500 flex items-center gap-3 border border-red-100 dark:border-red-900/30">
                        <i class="fas fa-trash text-lg"></i> Resetar F√°brica
                    </button>
                </div>
                
                <div class="text-center text-[9px] text-gray-300 pb-4">
                    QuantixNutri Ultimate v2.0 Final Build
                </div>
            </div>

        </main>

        <!-- BOTTOM NAVIGATION BAR (Fixed height and position) -->
        <nav class="absolute bottom-12 left-4 right-4 h-20 bg-white/95 dark:bg-dark-card/95 backdrop-blur border border-gray-100 dark:border-dark-border flex justify-around items-start pt-4 z-40 pb-6 rounded-2xl shadow-xl">
            <button onclick="App.switchTab('tracker')" class="nav-item active flex flex-col items-center w-1/3 btn-press group">
                <i class="fas fa-home text-xl mb-1 group-hover:scale-110 transition"></i>
                <span class="text-[9px] font-bold uppercase tracking-wide">Di√°rio</span>
                <div class="nav-indicator"></div>
            </button>
            <button onclick="App.switchTab('analytics')" class="nav-item flex flex-col items-center w-1/3 btn-press group">
                <i class="fas fa-chart-pie text-xl mb-1 group-hover:scale-110 transition"></i>
                <span class="text-[9px] font-bold uppercase tracking-wide">An√°lise</span>
                <div class="nav-indicator"></div>
            </button>
            <button onclick="App.switchTab('profile')" class="nav-item flex flex-col items-center w-1/3 btn-press group">
                <i class="fas fa-user-astronaut text-xl mb-1 group-hover:scale-110 transition"></i>
                <span class="text-[9px] font-bold uppercase tracking-wide">Perfil</span>
                <div class="nav-indicator"></div>
            </button>
        </nav>

        <!-- MODAL: ADD FOOD (Bottom Sheet) -->
        <div id="modal-add-food" class="modal-overlay">
            <div class="modal-content pb-6">
                <div class="flex justify-center pt-2 pb-4">
                    <div class="w-12 h-1.5 bg-gray-200 dark:bg-gray-700 rounded-full"></div>
                </div>
                
                <div class="px-5">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-bold text-lg">Registrar Alimento</h3>
                        <button onclick="Modal.close('add-food')" class="text-gray-400 hover:text-red-500"><i class="fas fa-times text-xl"></i></button>
                    </div>

                    <!-- REVIEW AREA (New Feature: Hidden by default) -->
                    <div id="inp-area-review" class="hidden space-y-4 animate-fade-in">
                        <div class="bg-brand-50 dark:bg-brand-900/10 p-4 rounded-xl border border-brand-100 dark:border-brand-800/30">
                            <h4 class="text-xs font-bold text-brand-600 uppercase mb-3 flex items-center gap-2">
                                <i class="fas fa-edit"></i> Revisar Item
                            </h4>
                            
                            <!-- Editable Description & Recalculate -->
                            <div class="mb-3">
                                <label class="text-[10px] text-gray-400 font-bold uppercase">Nome / Descri√ß√£o</label>
                                <div class="flex gap-2">
                                    <input type="text" id="rev-desc" class="flex-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl p-3 text-sm font-bold outline-none">
                                    <button onclick="App.recalculateReview()" id="btn-recalc" class="px-3 bg-blue-100 text-blue-600 rounded-xl flex items-center justify-center shadow-sm" title="Recalcular com IA">
                                        <i class="fas fa-sync-alt"></i>
                                    </button>
                                </div>
                                <p class="text-[9px] text-gray-400 mt-1">Edite o nome e clique no √≠cone azul para recalcular.</p>
                            </div>

                            <!-- Editable Stats -->
                            <div class="grid grid-cols-2 gap-3 mb-3">
                                <div>
                                    <label class="text-[10px] text-gray-400 font-bold uppercase">Calorias</label>
                                    <input type="number" id="rev-cals" class="w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl p-3 text-sm outline-none">
                                </div>
                                <div class="grid grid-cols-3 gap-1">
                                    <div>
                                        <label class="text-[9px] text-blue-500 font-bold uppercase text-center block">Prot</label>
                                        <input type="number" id="rev-p" class="w-full text-center bg-white dark:bg-gray-800 rounded-lg p-2 text-xs border border-gray-100 dark:border-gray-700">
                                    </div>
                                    <div>
                                        <label class="text-[9px] text-green-500 font-bold uppercase text-center block">Carb</label>
                                        <input type="number" id="rev-c" class="w-full text-center bg-white dark:bg-gray-800 rounded-lg p-2 text-xs border border-gray-100 dark:border-gray-700">
                                    </div>
                                    <div>
                                        <label class="text-[9px] text-yellow-500 font-bold uppercase text-center block">Gord</label>
                                        <input type="number" id="rev-f" class="w-full text-center bg-white dark:bg-gray-800 rounded-lg p-2 text-xs border border-gray-100 dark:border-gray-700">
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex gap-2">
                            <button onclick="App.cancelReview()" class="flex-1 py-3 bg-gray-100 text-gray-500 rounded-xl font-bold">Cancelar</button>
                            <button onclick="App.confirmReview()" class="flex-[2] py-3 bg-brand-500 text-white rounded-xl font-bold shadow-lg flex justify-center items-center gap-2">
                                <i class="fas fa-save"></i> Confirmar
                            </button>
                        </div>
                    </div>

                    <!-- NORMAL INPUT AREAS -->
                    <div id="inp-wrapper-normal">
                        <!-- Input Method Tabs -->
                        <div class="flex gap-2 mb-4">
                            <button onclick="Input.setMode('ai')" id="btn-mode-ai" class="flex-1 py-2 bg-brand-500 text-white rounded-xl text-xs font-bold transition">IA Nutri</button>
                            <button onclick="Input.setMode('manual')" id="btn-mode-manual" class="flex-1 py-2 bg-gray-100 dark:bg-gray-700 text-gray-500 rounded-xl text-xs font-bold transition">Manual</button>
                            <button onclick="Input.setMode('exercise')" id="btn-mode-exercise" class="flex-1 py-2 bg-blue-50 text-blue-500 border border-blue-100 rounded-xl text-xs font-bold transition">Exerc√≠cio</button>
                        </div>

                        <!-- Category Selector -->
                        <div class="mb-4">
                            <div class="flex gap-2 overflow-x-auto scrollbar-hide" id="category-chips">
                                <button onclick="Input.setCat('Caf√© da Manh√£')" class="cat-chip active px-3 py-1 bg-gray-100 rounded-full text-xs font-bold whitespace-nowrap border border-transparent">‚òï Caf√©</button>
                                <button onclick="Input.setCat('Almo√ßo')" class="cat-chip px-3 py-1 bg-gray-100 rounded-full text-xs font-bold whitespace-nowrap border border-transparent">üçõ Almo√ßo</button>
                                <button onclick="Input.setCat('Lanche')" class="cat-chip px-3 py-1 bg-gray-100 rounded-full text-xs font-bold whitespace-nowrap border border-transparent">üçé Lanche</button>
                                <button onclick="Input.setCat('Jantar')" class="cat-chip px-3 py-1 bg-gray-100 rounded-full text-xs font-bold whitespace-nowrap border border-transparent">üç≤ Jantar</button>
                            </div>
                        </div>

                        <!-- AI Input Area -->
                        <div id="inp-area-ai" class="space-y-3">
                            <div class="flex gap-3">
                                <button onclick="App.openCamera()" class="flex-1 h-32 bg-gray-50 dark:bg-gray-800 border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-2xl flex flex-col items-center justify-center text-gray-400 hover:text-brand-500 hover:border-brand-500 transition group">
                                    <div class="w-10 h-10 rounded-full bg-white dark:bg-gray-700 shadow-sm flex items-center justify-center mb-2 group-hover:scale-110 transition">
                                        <i class="fas fa-camera text-lg"></i>
                                    </div>
                                    <span class="text-[10px] font-bold uppercase">Tirar Foto</span>
                                </button>
                                
                                <!-- FILE UPLOAD BUTTON -->
                                <button onclick="document.getElementById('inp-image').click()" class="flex-1 h-32 bg-gray-50 dark:bg-gray-800 border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-2xl flex flex-col items-center justify-center text-gray-400 hover:text-blue-500 hover:border-blue-500 transition group">
                                    <div class="w-10 h-10 rounded-full bg-white dark:bg-gray-700 shadow-sm flex items-center justify-center mb-2 group-hover:scale-110 transition">
                                        <i class="fas fa-image text-lg"></i>
                                    </div>
                                    <span class="text-[10px] font-bold uppercase">Galeria</span>
                                </button>
                                <input type="file" id="inp-image" class="hidden" accept="image/*" onchange="App.handleImagePreview(this)">
                            </div>
                            
                            <div class="space-y-2 relative">
                                <textarea id="ai-desc" placeholder="Descreva sua refei√ß√£o em detalhes (ex: 2 pratos de arroz, 2 fatias de tender e 3 batatas cozidas)..." class="input-field w-full h-32 rounded-2xl p-3 text-sm outline-none resize-none"></textarea>
                                <button onclick="App.toggleVoice('ai-desc')" id="btn-mic-ai-desc" class="absolute bottom-3 right-3 w-8 h-8 rounded-full bg-brand-500 text-white flex items-center justify-center shadow-lg hover:scale-110 transition">
                                    <i class="fas fa-microphone"></i>
                                </button>
                            </div>
                            
                            <!-- Preview -->
                            <div id="ai-preview" class="hidden relative h-32 rounded-xl overflow-hidden bg-black group">
                                <img id="ai-preview-img" class="w-full h-full object-cover opacity-80">
                                <button onclick="App.clearImage()" class="absolute top-2 right-2 bg-red-500 text-white w-6 h-6 rounded-full flex items-center justify-center shadow"><i class="fas fa-times text-xs"></i></button>
                                
                                <!-- Portion Selector -->
                                <div class="absolute bottom-0 left-0 right-0 p-2 bg-gradient-to-t from-black/80 to-transparent flex gap-2 justify-center">
                                    <button onclick="App.setPortion(0.25, this)" class="portion-btn">1/4</button>
                                    <button onclick="App.setPortion(0.5, this)" class="portion-btn">1/2</button>
                                    <button onclick="App.setPortion(1, this)" class="portion-btn active">1x</button>
                                    <button onclick="App.setPortion(2, this)" class="portion-btn">2x</button>
                                </div>
                            </div>

                            <button onclick="App.analyzeAI()" id="btn-analyze" class="w-full py-4 bg-gradient-to-r from-brand-500 to-emerald-600 text-white rounded-xl font-bold shadow-glow-green btn-press flex justify-center items-center gap-2">
                                <span>Analisar</span> <i class="fas fa-wand-magic-sparkles"></i>
                            </button>
                            <p id="ai-loading" class="hidden text-center text-xs text-brand-600 animate-pulse font-bold">Processando imagem e contexto...</p>
                        </div>

                        <!-- Manual Input Area -->
                        <div id="inp-area-manual" class="hidden space-y-3">
                            <input type="text" id="man-desc" placeholder="Nome do alimento" class="input-field w-full rounded-xl p-3 text-sm font-bold">
                            <div class="grid grid-cols-2 gap-3">
                                <input type="number" id="man-cals" placeholder="Calorias (kcal)" class="input-field w-full rounded-xl p-3 text-sm">
                                <input type="number" id="man-prot" placeholder="Prote√≠na (g)" class="input-field w-full rounded-xl p-3 text-sm">
                                <input type="number" id="man-carb" placeholder="Carboidrato (g)" class="input-field w-full rounded-xl p-3 text-sm">
                                <input type="number" id="man-fat" placeholder="Gordura (g)" class="input-field w-full rounded-xl p-3 text-sm">
                            </div>
                            <input type="number" id="man-fiber" placeholder="Fibras (g)" class="input-field w-full rounded-xl p-3 text-sm">
                            <button onclick="App.addManual()" class="w-full py-3 bg-gray-900 text-white rounded-xl font-bold btn-press">Adicionar Manualmente</button>
                        </div>

                        <!-- Exercise Input Area -->
                        <div id="inp-area-exercise" class="hidden space-y-3">
                            <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-2xl border border-blue-100 dark:border-blue-800/30">
                                <h4 class="text-xs font-bold text-blue-500 uppercase mb-2">Registrar Atividade</h4>
                                <div class="relative mb-2">
                                    <input type="text" id="exe-desc" placeholder="Ex: Corrida 5km" class="input-field w-full rounded-xl p-3 pr-10 text-sm font-bold">
                                    <button onclick="App.toggleVoice('exe-desc')" id="btn-mic-exe-desc" class="absolute right-2 top-1/2 -translate-y-1/2 w-8 h-8 rounded-full text-blue-500 hover:bg-blue-100 flex items-center justify-center transition">
                                        <i class="fas fa-microphone"></i>
                                    </button>
                                </div>
                                
                                <button onclick="App.analyzeExerciseAI()" id="btn-analyze-ex" class="w-full py-2 mb-2 bg-blue-100 dark:bg-blue-900/40 text-blue-600 dark:text-blue-300 rounded-lg text-xs font-bold flex items-center justify-center gap-2 hover:bg-blue-200 transition">
                                    <i class="fas fa-magic"></i> Calcular Gasto com IA
                                </button>
                                <p id="ex-loading" class="hidden text-center text-xs text-blue-500 animate-pulse font-bold mb-2">Calculando esfor√ßo...</p>

                                <input type="number" id="exe-cals" placeholder="Calorias Queimadas (kcal)" class="input-field w-full rounded-xl p-3 text-sm font-bold">
                            </div>
                            <button onclick="App.addExercise()" class="w-full py-3 bg-blue-500 text-white rounded-xl font-bold btn-press shadow-glow-blue">Registrar Queima üî•</button>
                        </div>
                    </div>

                    <!-- Favorites / Recent -->
                    <div class="mt-4 pt-4 border-t border-gray-100 dark:border-gray-800">
                        <p class="text-[10px] font-bold text-gray-400 uppercase mb-2">Sugest√µes R√°pidas</p>
                        <div class="flex gap-2 overflow-x-auto scrollbar-hide pb-2" id="quick-add-container">
                            <!-- Injected -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- MODAL: FRIDGE CLEAROUT -->
        <div id="modal-fridge" class="modal-overlay">
            <div class="modal-content pb-6">
                <div class="flex justify-center pt-2 pb-4">
                    <div class="w-12 h-1.5 bg-gray-200 dark:bg-gray-700 rounded-full"></div>
                </div>
                <div class="px-5">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-bold text-lg">Limpa Geladeira IA</h3>
                        <button onclick="Modal.close('fridge')" class="text-gray-400"><i class="fas fa-times text-xl"></i></button>
                    </div>
                    <p class="text-xs text-gray-400 mb-4">Diga o que voc√™ tem em casa ou tire uma foto da sua geladeira/despensa.</p>
                    
                    <div class="flex gap-3 mb-4">
                        <button onclick="App.openCamera('fridge')" class="flex-1 h-20 bg-gray-50 dark:bg-gray-800 border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-2xl flex flex-col items-center justify-center text-gray-400 hover:text-blue-500 hover:border-blue-500 transition group">
                            <i class="fas fa-camera text-lg mb-1 group-hover:scale-110 transition"></i>
                            <span class="text-[9px] font-bold uppercase">C√¢mera</span>
                        </button>
                        <button onclick="document.getElementById('fridge-image-input').click()" class="flex-1 h-20 bg-gray-50 dark:bg-gray-800 border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-2xl flex flex-col items-center justify-center text-gray-400 hover:text-blue-500 hover:border-blue-500 transition group">
                            <i class="fas fa-image text-lg mb-1 group-hover:scale-110 transition"></i>
                            <span class="text-[9px] font-bold uppercase">Galeria</span>
                        </button>
                        <input type="file" id="fridge-image-input" class="hidden" accept="image/*" onchange="App.handleImagePreview(this, 'fridge')">
                    </div>

                    <div id="fridge-preview" class="hidden relative h-32 rounded-xl overflow-hidden bg-black mb-4">
                        <img id="fridge-preview-img" class="w-full h-full object-cover opacity-80">
                        <button onclick="App.clearImage('fridge')" class="absolute top-2 right-2 bg-red-500 text-white w-6 h-6 rounded-full flex items-center justify-center shadow"><i class="fas fa-times text-xs"></i></button>
                    </div>

                    <div class="relative mb-4">
                        <textarea id="fridge-ingredients" placeholder="Ex: 2 ovos, meio tomate, um pouco de queijo e sobras de frango..." class="input-field w-full h-24 rounded-2xl p-3 text-sm outline-none resize-none"></textarea>
                        <button onclick="App.toggleVoice('fridge-ingredients')" id="btn-mic-fridge-ingredients" class="absolute bottom-3 right-3 w-8 h-8 rounded-full bg-blue-500 text-white flex items-center justify-center shadow-lg hover:scale-110 transition">
                            <i class="fas fa-microphone"></i>
                        </button>
                    </div>
                    
                    <button onclick="App.fridgeClearoutAI()" id="btn-fridge-analyze" class="w-full py-4 bg-blue-600 text-white rounded-xl font-bold shadow-lg btn-press flex justify-center items-center gap-2">
                        <span>Gerar Receita</span> <i class="fas fa-magic"></i>
                    </button>
                    
                    <div id="fridge-result" class="hidden mt-4 p-4 bg-gray-50 dark:bg-gray-900 rounded-2xl border border-gray-100 dark:border-gray-800">
                        <h4 class="text-xs font-bold text-blue-600 uppercase mb-2">Sugest√£o do Chef:</h4>
                        <div id="fridge-recipe-text" class="text-sm text-gray-700 dark:text-gray-300 leading-relaxed"></div>
                        <button onclick="Modal.close('fridge')" class="mt-4 w-full py-2 bg-gray-200 dark:bg-gray-800 rounded-lg text-xs font-bold">Entendido!</button>
                    </div>
                    
                    <p id="fridge-loading" class="hidden text-center text-xs text-blue-600 animate-pulse font-bold mt-4">Criando receita personalizada...</p>
                </div>
            </div>
        </div>

    </div>
    <script src="app.js"></script>
</body>
</html>